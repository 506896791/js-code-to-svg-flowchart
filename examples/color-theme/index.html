<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
    <body>

        <div>
            <p id="svgImage"></p>
        </div>

        <script src="../../dist/js2flowchart.js"></script>
        <script>
            var code = `
                console.log('test 0');

                function traverseDoc(doc, onEnter, onExit, shouldTraverseConditionalGroups) {
                  function traverseDocRec(doc) {
                    let shouldRecurse = true;
                    console.log('test 1')
                    if (onEnter) {
                      if (onEnter(doc) === false) {
                        shouldRecurse = false;
                      }
                    }

                    if (shouldRecurse) {
                      if (doc.type === "concat" || doc.type === "fill") {
                        for (let i = 0; i < doc.parts.length; i++) {
                          traverseDocRec(doc.parts[i]);
                        }
                      } else if (doc.type === "if-break") {
                        if (doc.breakContents) {
                          traverseDocRec(doc.breakContents);
                        }
                        if (doc.flatContents) {
                          traverseDocRec(doc.flatContents);
                          console.log('test 2')
                        }
                      } else if (doc.type === "group" && doc.expandedStates) {
                        if (shouldTraverseConditionalGroups) {
                          doc.expandedStates.forEach(traverseDocRec);
                        } else {
                          traverseDocRec(doc.contents);
                        }
                      } else if (doc.contents) {
                        traverseDocRec(doc.contents);

                        console.log('test 3')
                      }
                    }

                    if (onExit) {
                      onExit(doc);
                    }
                  }

                  traverseDocRec(doc);
                }

                function doLogging() {
                    const test = 'ignore';
                }

                function logout() {
                    const test = 'ignore';
                }
            `;

            const JS2FlowChart = window['js2flowchart'];

            const flowTreeBuilder = JS2FlowChart.createFlowTreeBuilder();

            const svgRender = JS2FlowChart.createSVGRender();
            svgRender.applyBlurredTheme();

            const shapesTree = svgRender.buildShapesTree(flowTreeBuilder.build(code));

            document.getElementById('svgImage').innerHTML = shapesTree.print();
        </script>

    </body>
</html>
